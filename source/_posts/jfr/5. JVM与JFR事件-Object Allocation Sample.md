---
title: JVM与JFR事件-Java Application/Object Allocation Outside TLAB
abbrlink: 19346
date: 2025-02-22 14:55:52
tags: [JVM, JFR, 监控, 对象分配]
categories: [JFR]
---

### 使用
- Type(JVM,JDK内部唯一标识，用于jfr配置): jdk.ObjectAllocationSample
- Label(Event Type，用于显示): Object Allocation Sample
- Category(用于分类显示): Java Application
- 事件从`Java16`引入(目的是想有一个采集消耗不像 `ObjectAllocationInNewTLAB` 这么大的事件)
- 事件类型
  - `埋点事件：即满足某些条件会触发的采集事件`
  - `JVM内部事件`
- default.jfc 配置
  ```xml
    <event name="jdk.ObjectAllocationSample">
        <setting name="enabled" control="object-allocation-enabled">true</setting>
        <setting name="throttle" control="allocation-profiling">150/s</setting>
        <setting name="stackTrace">true</setting>
    </event>
  ```
- Profiling.jfc 配置
  ```xml
    <event name="jdk.ObjectAllocationSample">
        <setting name="enabled" control="object-allocation-enabled">true</setting>
        <setting name="throttle" control="allocation-profiling">300/s</setting>
        <setting name="stackTrace">true</setting>
    </event>
  ```
- 此事件对应 [Java对象分配过程](https://taeyang0126.github.io/2025/02/22/jvm/java-dui-xiang-fen-pei-guo-cheng/posts/undefined/?highlight=%E5%AF%B9%E8%B1%A1%E5%88%86%E9%85%8D) 中的`路径二、路径三、路径四`
- `路径二、路径三` 分配一定进入采样中，`路径四` 分配失败不会进入采样中